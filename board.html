<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Digitaler Notentisch - Projekt Notentisch</title>
    <style>
        body { display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr auto; height: 100vh; margin: 0; background: #121212; font-family: 'Segoe UI', sans-serif; overflow: hidden; color: white; }
        
        .quadrant { border: 1px solid #333; position: relative; display: flex; flex-direction: column; align-items: center; padding: 60px 10px 10px; overflow-y: auto; cursor: pointer; }
        .quadrant.active { border: 2px solid #3498db; }
        
        .quadrant::before { position: absolute; top: 15px; font-size: 1.2rem; opacity: 0.4; font-weight: bold; color: #3498db; text-transform: uppercase; }
        #neueIdee::before { content: "Neue Idee (Q1)"; left: 20px; }
        #wiederholen::before { content: "Wiederholen (Q2)"; right: 20px; }
        #geuebt::before { content: "Geübt (Q3)"; left: 20px; }
        #gelernt::before { content: "Gelernt (Q4)"; right: 20px; }

        .center-hole { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 900px; height: 520px; background: #2c3e50; border-radius: 20px; z-index: 1000; box-shadow: 0 0 50px rgba(0,0,0,0.9); display: flex; flex-direction: column; align-items: center; justify-content: flex-start; gap: 10px; border: 3px solid #3498db; padding: 10px; box-sizing: border-box; }
        #center-content { width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; overflow: hidden; position: relative; }
        
        .control-bar { grid-column: 1 / 3; background: #1a1a1a; border-top: 1px solid #333; padding: 8px; display: flex; justify-content: center; align-items: center; gap: 8px; font-size: 11px; }
        .control-bar .btn { padding: 6px 10px; font-size: 10px; width: auto; }
        .control-bar input { width: 40px; height: 20px; padding: 2px; font-size: 10px; }

        .card-container { width: 190px; text-align: center; flex-shrink: 0; cursor: grab; display: none; }
        .card-container.visible { display: block; }
        .card-container.in-center { border: 3px solid #3498db; box-shadow: 0 0 15px #3498db; border-radius: 8px; }
        .card { width: 100%; height: 250px; background: white; border-radius: 4px; box-shadow: 0 5px 15px rgba(0,0,0,0.6); pointer-events: none; background-size: cover; background-position: top; }
        .card-title { font-size: 11px; color: #ccc; margin-top: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; padding: 0 5px; }

        /* Cards an äußeren Rändern */
        #neueIdee .card-container { position: absolute !important; top: 50px; left: 10px; transform: none; }
        #wiederholen .card-container { position: absolute !important; top: 50px; right: 10px; transform: none; }
        #geuebt .card-container { position: absolute !important; top: 50px; left: 10px; transform: none; }
        #gelernt .card-container { position: absolute !important; top: 50px; right: 10px; transform: none; }

        #neueIdee .card-container.visible:nth-child(1), #wiederholen .card-container.visible:nth-child(1), 
        #geuebt .card-container.visible:nth-child(1), #gelernt .card-container.visible:nth-child(1) { z-index: 10; top: 50px; }
        #neueIdee .card-container.visible:nth-child(2), #wiederholen .card-container.visible:nth-child(2), 
        #geuebt .card-container.visible:nth-child(2), #gelernt .card-container.visible:nth-child(2) { z-index: 11; top: 100px; }
        #neueIdee .card-container.visible:nth-child(3), #wiederholen .card-container.visible:nth-child(3), 
        #geuebt .card-container.visible:nth-child(3), #gelernt .card-container.visible:nth-child(3) { z-index: 12; top: 150px; }
        #neueIdee .card-container.visible:nth-child(4), #wiederholen .card-container.visible:nth-child(4), 
        #geuebt .card-container.visible:nth-child(4), #gelernt .card-container.visible:nth-child(4) { z-index: 13; top: 200px; }
        #neueIdee .card-container.visible:nth-child(5), #wiederholen .card-container.visible:nth-child(5), 
        #geuebt .card-container.visible:nth-child(5), #gelernt .card-container.visible:nth-child(5) { z-index: 14; top: 250px; }
        #neueIdee .card-container.visible:nth-child(n+6), #wiederholen .card-container.visible:nth-child(n+6), 
        #geuebt .card-container.visible:nth-child(n+6), #gelernt .card-container.visible:nth-child(n+6) { z-index: 15; top: 300px; }

        #neueIdee .card-container:hover, #geuebt .card-container:hover { z-index: 100 !important; transform: scale(1.05) translateX(-10px); }
        #wiederholen .card-container:hover, #gelernt .card-container:hover { z-index: 100 !important; transform: scale(1.05) translateX(10px); }
        
        .btn { cursor: pointer; padding: 10px; border-radius: 6px; border: none; background: #3498db; color: white; font-weight: bold; width: 85%; }
        .btn:hover { background: #2980b9; }
        #stackLimit { width: 45px; background: #1a1a1a; color: white; border: 1px solid #3498db; text-align: center; border-radius: 3px; }
        #fileInput { display: none; }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    </script>
</head>
<body>
    <div class="center-hole" id="CENTER" ondrop="drop(event)" ondragover="allow(event)">
        <img src="center.png" style="width:50px; opacity:0.3; margin-bottom: 4px;" alt="">
        <div id="center-content">
            <div style="text-align:center; color:#9aa; font-size:12px;">PDF im Center anzeigen</div>
        </div>
    </div>

    <div id="neueIdee" class="quadrant" ondrop="drop(event)" ondragover="allow(event)"></div>
    <div id="wiederholen" class="quadrant" ondrop="drop(event)" ondragover="allow(event)"></div>
    <div id="geuebt" class="quadrant" ondrop="drop(event)" ondragover="allow(event)"></div>
    <div id="gelernt" class="quadrant" ondrop="drop(event)" ondragover="allow(event)"></div>

    <div class="control-bar">
        <button class="btn" onclick="document.getElementById('fileInput').click()">LADEN</button>
        <button class="btn" onclick="saveXml()">SPEICHERN</button>
        <span style="color: #666;">|</span>
        <button class="btn" onclick="switchLayout()" id="layoutBtn">Layout: 2x2</button>
        <span style="color: #666;">|</span>
        <button class="btn" onclick="togglePagesPerView()" id="pagesBtn" style="width: auto; padding: 6px 10px;">2 Seiten</button>
        <span style="color: #666;">|</span>
        <button class="btn" onclick="previousPage()" style="width: auto; padding: 6px 8px;">↑</button>
        <span id="pageInfo" style="min-width: 60px; text-align:center;"></span>
        <button class="btn" onclick="nextPage()" style="width: auto; padding: 6px 8px;">↓</button>
        <span style="color: #666;">|</span>
        <label style="display: flex; align-items: center; gap: 3px;">L: <input type="number" id="stackLimit" value="8" min="1" onchange="renderBoard()"></label>
        <label style="display: flex; align-items: center; gap: 3px;">S: <input type="number" id="stackOffset" value="30" min="10" onchange="renderBoard()">px</label>
        <input type="file" id="fileInput" accept=".xml" onchange="handleFile(event)">
    </div>

    <script src="board.js"></script>
</body>
</html>